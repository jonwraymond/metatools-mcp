server:
  name: metatools-mcp
  version: "dev"

transport:
  type: stdio  # stdio | streamable | sse
  http:
    host: 0.0.0.0
    port: 8080
    tls:
      enabled: false
      cert: ""
      key: ""
  streamable:
    stateless: false        # Disable session management
    json_response: false    # Prefer JSON over SSE streaming
    session_timeout: 30m    # Idle session cleanup

search:
  strategy: lexical
  bm25:
    name_boost: 3
    namespace_boost: 2
    tags_boost: 2
    max_docs: 0
    max_doctext_len: 0
  semantic:
    embedder: ""   # BYO embedder key for semantic/hybrid search
    config: {}
    weight: 0.5

execution:
  timeout: 30s
  max_tool_calls: 64
  max_chain_steps: 8

providers:
  search_tools:
    enabled: true
  list_tools:
    enabled: true
  list_namespaces:
    enabled: true
  describe_tool:
    enabled: true
  list_tool_examples:
    enabled: true
  run_tool:
    enabled: true
  run_chain:
    enabled: true
  execute_code:
    enabled: false
    sandbox: dev
  list_toolsets:
    enabled: true
  describe_toolset:
    enabled: true
  list_skills:
    enabled: true
  describe_skill:
    enabled: true
  plan_skill:
    enabled: true
  run_skill:
    enabled: true

toolsets:
  - name: "core"
    description: "Core safe tools"
    namespace_filters: ["local", "core"]
    tag_filters: ["safe"]
    allow_ids: []
    deny_ids: []
    policy: "allow_all"

skills:
  - name: "ping_check"
    description: "Run a simple ping tool"
    toolset_id: "toolset:core"
    steps:
      - id: "ping"
        tool_id: "local.ping"
        inputs: {}
    guards:
      max_steps: 4
      allow_ids: []

skill_defaults:
  max_steps: 8
  max_tool_calls: 32
  timeout: 30s

backends:
  local:
    enabled: true
    paths: []
    watch: false
  mcp:
    - name: "deepwiki"
      url: "https://mcp.deepwiki.com/mcp"
      headers: {}
      max_retries: 5
  mcp_refresh:
    interval: 10m
    jitter: 30s
    stale_after: 15m
    on_demand: true

health:
  enabled: true
  http_path: /healthz

middleware:
  chain: []
  configs:
    # auth:
    #   config:
    #     allow_anonymous: false
    #     authenticators:
    #       - name: "jwt"
    #         config:
    #           issuer: "https://auth.example.com"
    #           audience: "metatools"
    #           jwks_url: "https://auth.example.com/.well-known/jwks.json"
    #     authorizer:
    #       name: "allow_all"
    #     allow_anonymous: false
  observe:
    enabled: false
    config: {}
  cache:
    enabled: false
    policy:
      ttl: 5m
  resilience:
    enabled: false
    retry:
      enabled: false
      config: {}
    circuit:
      enabled: false
      config: {}
    timeout: 30s
